{% extends 'base.html' %}
{% load static %}
{% block title %}ูพูู ุฏุจุฑุงู{% endblock %}

{% block header %}{% endblock %}
{% block footer %}{% endblock %}

{% block content %}
<div class="teacher-dashboard">
  <!-- ูุฏุฑ ุฏุงุฎู -->


  <!-- ฺฉุงุฑุชโูุง ุงูฺฉุงูุงุช -->
  <div class="teacher-cards">
    <div class="feature-card">
      <div class="card-icon">๐</div>
      <h3>ุขูพููุฏ ูุงู ุฏุฑุณ</h3>
      <p>ุจุงุฑฺฏุฐุงุฑ ุฌุฒูุงุชุ ุชูุฑูุงุช ู ููุงุจุน ุขููุฒุด</p>
      <button class="upload-btn" onclick="document.getElementById('uploadLessonModal').style.display='block'">ุขูพููุฏ ูุงู</button>
    </div>
    <div class="feature-card">
      <div class="card-icon">๐</div>
      <h3>ุขูพููุฏ ููุงูู</h3>
      <p>ุงูุชุดุงุฑ ููุงูุงุช ุขููุฒุด ู ูพฺููุด</p>
      <button class="upload-btn" onclick="document.getElementById('uploadArticleModal').style.display='block'">ุขูพููุฏ ููุงูู</button>
    </div>
    <div class="feature-card">
      <div class="card-icon">๐ฌ</div>
      <h3>ูุดุงูุฑู ุชุญุตู</h3>
      <p>ูุฏุฑุช ุฌูุณุงุช ูุดุงูุฑู ุจุง ุฏุงูุดโุขููุฒุงู</p>
      <button class="upload-btn" onclick="document.getElementById('consultationModal').style.display='block'">ูุฏุฑุช ูุดุงูุฑู</button>
    </div>
  </div>
</div>

<!-- ููุฏุงู ุขูพููุฏ ูุงู ุฏุฑุณ -->
<div id="uploadLessonModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ุขูพููุฏ ูุงู ุฏุฑุณ</h3>
      <span class="close" onclick="document.getElementById('uploadLessonModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <form method="POST" action="{% url 'avisina:teacher_dashboard' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ lesson_form.non_field_errors }}
        <div class="form-group">
          <label for="id_title">ุนููุงู ูุงู</label>
          {{ lesson_form.title }}
        </div>
        <div style="display:none;">
            {{ lesson_form.name }}
        </div>
        <div class="form-group">
          <label for="id_description">ุชูุถุญุงุช</label>
          {{ lesson_form.description }}
        </div>
        <div class="form-group">
          <label for="id_file">ุงูุชุฎุงุจ ูุงู</label>
          <div class="file-upload-area"> 
            <div style="display:none;">
            {{ lesson_form.file }}
            </div>
            <div class="upload-placeholder" id="lessonUploadTrigger">
              <span class="upload-icon">๐</span>
              <p>ูุงู ุฎูุฏ ุฑุง ุงูุฌุง ุฑูุง ฺฉูุฏ ุง ฺฉูฺฉ ฺฉูุฏ</p>
              <span class="file-types">ูพุดุชุจุงู ุงุฒ: PDF</span>
            </div>
          </div>
        </div>
        <div class="form-actions">
          <button type="submit" name="submit_lesson" class="btn-submit">ุขูพููุฏ ูุงู</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ููุฏุงู ุขูพููุฏ ููุงูู -->
<div id="uploadArticleModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ุขูพููุฏ ููุงูู</h3>
      <span class="close" onclick="document.getElementById('uploadArticleModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
      <form method="POST" action="{% url 'avisina:teacher_dashboard' %}" enctype="multipart/form-data">
        {% csrf_token %}
        {{ article_form.non_field_errors }}
        <div class="form-group">
          <label for="id_title">ุนููุงู ููุงูู</label>
          {{ article_form.title }}
        </div>
        <div class="form-group">
          <label for="id_text">ุชูุถุญุงุช</label>
          {{ article_form.text }}
        </div>
        <div class="form-group">
          <label for="id_picture">ุงูุชุฎุงุจ ูุงู</label>
          <div class="file-upload-area">
            <div style="display:none;">
            {{ article_form.picture }}
            </div>
            <div class="upload-placeholder" id="articleUploadTrigger">
              <span class="upload-icon">๐</span>
              <p>ูุงู ุฎูุฏ ุฑุง ุงูุฌุง ุฑูุง ฺฉูุฏ ุง ฺฉูฺฉ ฺฉูุฏ</p>
              <span class="file-types">ูพุดุชุจุงู ุงุฒ: PDF, Word, PowerPoint, Image</span>
            </div>
          </div>
        </div>
        <div style="display:none;">
            {{ article_form.writer }}
        </div>
        <div class="form-actions">
          <button type="submit" name="submit_article" class="btn-submit">ุขูพููุฏ ููุงูู</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ููุฏุงู ูุดุงูุฑู -->
<div id="consultationModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ูุฏุฑุช ูุดุงูุฑู ุชุญุตู</h3>
      <span class="close" onclick="document.getElementById('consultationModal').style.display='none'">&times;</span>
    </div>
    <div class="modal-body">
    
        <div class="consultation-card">
          <h4>๐ฅ ุฏุงูุดโุขููุฒุงู</h4>
          <p>ูุฏุฑุช ูุณุช ุฏุงูุดโุขููุฒุงู ุชุญุช ูุดุงูุฑู</p>
          <button class="option-btn" onclick="window.location.href='{% url 'avisina:message' %}'">
            ูุดุงูุฏู ูุณุช
        </button>
        
        </div>
      
    </div>
  </div>
</div>

<script>
// ุงุชุตุงู ุธุงูุฑ ุณูุงุฑุด ุจู ููุฏ ูุงูุน ุขูพููุฏ
function setupUpload(triggerId, inputId) {
  const trigger = document.getElementById(triggerId);
  const input = document.getElementById(inputId);

  if (!trigger || !input) return;

  trigger.addEventListener('click', () => input.click());

  trigger.addEventListener('dragover', e => {
    e.preventDefault();
    trigger.style.background = '#f0f8ff';
  });

  trigger.addEventListener('dragleave', () => {
    trigger.style.background = '#f8f9fa';
  });

  trigger.addEventListener('drop', e => {
    e.preventDefault();
    trigger.style.background = '#f8f9fa';
    if (e.dataTransfer.files.length) {
      input.files = e.dataTransfer.files;
      updateFileLabel(trigger, input);
    }
  });

  input.addEventListener('change', () => updateFileLabel(trigger, input));
}

// ููุงุด ูุงู ูุงู ุงูุชุฎุงุจโุดุฏู
function updateFileLabel(trigger, input) {
  if (input.files.length > 0) {
    trigger.innerHTML = `
      <span class="upload-icon">โ</span>
      <p>${input.files[0].name}</p>
      <span class="file-types">ูุงู ุงูุชุฎุงุจ ุดุฏู</span>
    `;
  }
}

// ุฑุงูโุงูุฏุงุฒ ุขูพููุฏ ุจุฑุง ูุฑ ูุฑู
document.addEventListener('DOMContentLoaded', () => {
  setupUpload('lessonUploadTrigger', 'lesson_file');
  setupUpload('articleUploadTrigger', 'article_picture');
});

// ุจุณุชู ููุฏุงู ุจุง ฺฉูฺฉ ุฑู ูุถุง ุจุฑูู
window.addEventListener('click', function(e) {
  const modals = ['uploadLessonModal', 'uploadArticleModal', 'consultationModal'];
  modals.forEach(id => {
    const modal = document.getElementById(id);
    if (modal && e.target === modal) {
      modal.style.display = 'none';
    }
  });
});

</script>

{% endblock %}